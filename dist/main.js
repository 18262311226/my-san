(()=>{"use strict";function e(e){var t=e.match(/\s*([\$0-9a-z_]+)/gi,1);if(!t)throw new Error("[SAN FATAL] expect an ident: "+e.source.slice(e.index));return t[1]}function t(r){r.goUntil();var n=r.source.charCodeAt(r.index);switch(n){case 33:case 43:case 45:return r.index++,function(e,t){switch(t){case 33:var r;switch(e.type){case 2:case 1:case 3:r=!e.value;break;case 12:case 11:r=!1;break;case 13:r=!0}if(null!=r)return{type:3,value:r};break;case 43:switch(e.type){case 2:case 1:case 3:return{type:2,value:+e.value}}break;case 45:switch(e.type){case 2:case 1:case 3:return{type:2,value:-e.value}}}return{type:9,expr:e,operator:t}}(t(r),n);case 34:case 39:return function(e){var t,r=e.source.charCodeAt(e.index),n="";e:for(;t=e.nextCode();)switch(t){case 92:switch(t=e.nextCode()){case 117:n+=String.fromCharCode(parseInt(e.source.slice(e.index+1,e.index+5),16)),e.index+=4;break;case 120:n+=String.fromCharCode(parseInt(e.source.slice(e.index+1,e.index+3),16)),e.index+=2;break;case 98:n+="\b";break;case 102:n+="\f";break;case 110:n+="\n";break;case 114:n+="\r";break;case 116:n+="\t";break;case 118:n+="\v";break;default:n+=String.fromCharCode(t)}break;case r:e.index++;break e;default:n+=String.fromCharCode(t)}return{type:1,value:n}}(r);case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return{type:2,value:+r.match(/[0-9]+(\.[0-9]+)?/g,1)[0]};case 40:return function(e){e.index++;var t=i(e);return e.goUntil(41),t.parenthesized=!0,t}(r);case 91:r.index++;for(var a=[];!r.goUntil(93);){var o={};a.push(o),46===r.source.charCodeAt(r.index)&&r.match(/\.\.\.\s*/g)&&(o.spread=!0),o.expr=i(r),r.goUntil(44)}return{type:12,items:a};case 123:r.index++;for(var s=[];!r.goUntil(125);){if(o={},s.push(o),46===r.source.charCodeAt(r.index)&&r.match(/\.\.\.\s*/g))o.spread=!0,o.expr=i(r);else{var c=r.index;if(o.name=t(r),o.name.type>4)throw new Error("[SAN FATAL] unexpect object name: "+r.source.slice(c,r.index));r.goUntil(58)?o.expr=i(r):o.expr=o.name,4===o.name.type&&(o.name=o.name.paths[0])}r.goUntil(44)}return{type:11,items:s}}return function(t,r){t.goUntil();var n,a=function(t){var r=e(t);switch(r){case"true":case"false":return{type:3,value:"true"===r};case"null":return{type:13}}var n={type:4,paths:[{type:1,value:r}]};e:for(;;)switch(t.source.charCodeAt(t.index)){case 46:t.index++,n.paths.push({type:1,value:e(t)});break;case 91:t.index++,n.paths.push(i(t)),t.goUntil(93);break;default:break e}return n}(t);if(t.goUntil(40))for(n=[];!t.goUntil(41);)n.push(i(t)),t.goUntil(44);else r&&(n=r);return n&&(a={type:6,name:a,args:n}),a}(r)}function r(e){for(var r=t(e);;){e.goUntil();var n=e.source.charCodeAt(e.index);switch(n){case 37:case 42:case 47:e.index++,r={type:8,operator:n,segs:[r,t(e)]};continue}break}return r}function n(e){for(var t=r(e);;){e.goUntil();var n=e.source.charCodeAt(e.index);switch(n){case 43:case 45:e.index++,t={type:8,operator:n,segs:[t,r(e)]};continue}break}return t}function a(e){var t=n(e);e.goUntil();var r=e.source.charCodeAt(e.index);switch(r){case 60:case 62:return 61===e.nextCode()&&(r+=61,e.index++),{type:8,operator:r,segs:[t,n(e)]}}return t}function o(e){var t=function(e){var t=a(e);e.goUntil();var r=e.source.charCodeAt(e.index);switch(r){case 61:case 33:if(61===e.nextCode())return r+=61,61===e.nextCode()&&(r+=61,e.index++),{type:8,operator:r,segs:[t,a(e)]};e.index--}return t}(e);if(e.goUntil(),38===e.source.charCodeAt(e.index)){if(38===e.nextCode())return e.index++,{type:8,operator:76,segs:[t,o(e)]};e.index--}return t}function s(e){var t=o(e);if(e.goUntil(),124===e.source.charCodeAt(e.index)){if(124===e.nextCode())return e.index++,{type:8,operator:248,segs:[t,s(e)]};e.index--}return t}function i(e){var t=s(e);if(e.goUntil(),63===e.source.charCodeAt(e.index)){e.index++;var r=i(e);if(e.goUntil(),58===e.source.charCodeAt(e.index))return e.index++,{type:10,segs:[t,r,i(e)]}}return t}function c(e){this.source=e,this.len=e.length,this.index=0}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e){if(e)return"object"===u(e)&&e.type?e:i(new c(e))}function p(e,t,r){if(null!=e.value)return e.value;var n;switch(e.type){case 13:return null;case 9:switch(n=p(e.expr,t,r),e.operator){case 33:n=!n;break;case 43:n=+n;break;case 45:n=0-n}return n;case 8:return n=p(e.segs[0],t,r),p(e.segs[1],t,r),e.operator,n}}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function l(e,t){this.parent=t,this.raw=e||{},this.listeners=[]}c.prototype.nextCode=function(){return this.index++,this.source.charCodeAt(this.index)},c.prototype.goUntil=function(e){for(var t;this.index<this.len&&(t=this.source.charCodeAt(this.index));)switch(t){case 32:case 9:case 13:case 10:this.index++;break;default:return t===e?(this.index++,1):void 0}},c.prototype.match=function(e,t){e.lastIndex=this.index;var r=e.exec(this.source);if(console.log("match",r),r&&(!t||this.index===r.index))return this.index=e.lastIndex,r},l.prototype.get=function(e,t){var r=this.raw;if(!e)return r;"object"!==f(e)&&(e=d(e));var n=e.paths;if(t=t||this,void 0===(r=r[n[0].value])&&this.parent)r=this.parent.get(e,t);else for(var a=1,o=n.length;null!==r&&a<o;a++)r=r[n[a].value||p(n[a],t)];return r},l.prototype.immutableSet=function(e,t,r,n,a,o){},l.prototype.set=function(e,t,r){};var h={version:"1.0.0",parseExpr:d,Data:l};"undefined"!=typeof window&&(window.san=h)})();
//# sourceMappingURL=main.js.map